[TOC]



## STOI

STOI 是 **Short-Time Objective Intelligibility** 的缩写，是一种用于评估语音信号可懂度的客观指标。在语音增强任务中，STOI 被广泛用来衡量处理后的语音与原始干净语音在可懂性方面的相似程度。

### 含义
- STOI 主要关注语音的短时频谱特性。
- 它模拟人类听觉系统对语音的理解方式，通过比较纯净语音和带噪（或增强）语音的频谱相关性来预测语音的可懂度。
- STOI 的取值范围通常在 0 到 1 之间：
  - 0 表示完全不可懂；
  - 1 表示与参考语音完全一致，完全可懂。

### 计算步骤
STOI 的计算主要包括以下五个步骤：

1. **预处理**：
   
   - 将纯净语音 `s(t)` 和待测语音 `x(t)` 分别进行预加重（pre-emphasis），以补偿高频部分的能量衰减。
   
2. **短时傅里叶变换 (STFT)**：
   - 对两段语音分别进行 STFT 得到它们的复数频谱：
     ```python
     S = stft(s)
     X = stft(x)
     ```


3. **频谱分带**：
   - 将频谱划分为若干个等效矩形带宽（ERB）的子带，通常为 25 个左右。

4. **子带时间相关性计算**：
   - 对每个子带，在每一帧上计算纯净语音和测试语音之间的归一化互相关系数（normalized cross-correlation）：
     $$
     r_k(m) = \frac{\sum_n S_k(m,n) \cdot X_k^*(m,n)}{\sqrt{\sum_n |S_k(m,n)|^2 \cdot \sum_n |X_k(m,n)|^2}}
     $$
     其中：
     - $ k $：子带索引；
     - $ m $：帧索引；
     - $ n $：帧内采样点索引；
     - $ * $：共轭操作。

5. **平均得到最终得分**：
   - 对所有子带和所有帧上的相关系数取平均，即得最终的 STOI 指标：
     $$
     \text{STOI} = \frac{1}{KM} \sum_{k=1}^{K} \sum_{m=1}^{M} r_k(m)
     $$
     其中：
     - $ K $：子带总数；
     - $ M $：帧总数。

### 应用场景
- 语音增强（Speech Enhancement）
- 语音去噪（Noise Reduction）
- 语音分离（Speech Separation）
- 语音编码/压缩质量评估

### Python 实现（第三方库）
可以使用 `pystoi` 这个开源库快速实现 STOI 的计算：

```python
from pystoi import stoi
import numpy as np

# 假设 clean_signal 和 noisy_signal 是两个 numpy 数组，表示干净和带噪语音
score = stoi(clean_signal, enhanced_signal, fs_sig=16000, extended=False)
```


其中：
- `fs_sig` 是采样率；
- `extended=False` 表示使用标准 STOI，若设为 `True` 则使用扩展版本 ESTOI。

如需进一步了解如何集成该指标到训练流程中（如端到端语音增强模型），也可以结合 PyTorch 或 TensorFlow 实现自定义损失函数。



## PESQ

PESQ 是 **Perceptual Evaluation of Speech Quality** 的缩写，是一种广泛用于评估语音质量的客观指标，尤其在语音增强、语音编码和语音传输等领域中被广泛采用。

---

### 含义

- PESQ 模拟人类听觉系统，结合了语音的时域和频域特性，预测语音的主观听感质量。
- 它不仅考虑了语音的失真，还考虑了背景噪声、语音失真、时延等因素。
- PESQ 的输出分为两个主要评分：
  - **MOS-LQO（Mean Opinion Score - Listening Quality Objective）**：范围从 -0.5 到 4.5，表示语音的整体质量，越接近 4.5 表示质量越高。
  - **Delay（时延）**：估计测试语音相对于参考语音的延迟时间（毫秒），用于检测系统引入的延迟。

---

### 计算原理（简要）

1. **时域对齐**：
   - 对参考语音（干净语音）和测试语音进行时间对齐，消除时延影响。

2. **听觉建模**：
   - 模拟人耳听觉特性（如耳蜗滤波、响度感知等），将语音信号转换为感知域（perceptual domain）。

3. **频谱分析与比较**：
   - 在感知域中对语音信号进行频谱分析，提取关键听觉特征。
   - 计算每帧的误差（如频谱失真、响度差异等）。

4. **映射到主观评分 MOS-LQO**：
   - 将误差映射为一个与主观 MOS（Mean Opinion Score）高度相关的客观评分。

---

### 应用场景

- 语音增强（Speech Enhancement）
- 语音编码/解码（如 G.7xx 系列编码标准）
- 网络传输质量评估
- 语音去噪算法性能评估

---

### Python 实现（第三方库）

目前 PESQ 的实现主要依赖于 C/C++ 引擎的封装，Python 中常用 `pypesq` 或 `pesq` 库：

```bash
pip install pesq
```


使用示例：

```python
from pesq import pesq
import numpy as np

# clean_signal: 干净语音
# enhanced_signal: 增强后的语音
# fs: 采样率（8000 或 16000）
score = pesq(fs, clean_signal, enhanced_signal, 'wb')  # 'wb' 表示 wideband 模式
```


- `'nb'` 表示 narrowband（8kHz）
- `'wb'` 表示 wideband（16kHz）

---

### STOI vs PESQ

| 指标   | 侧重点                    | 输出范围   | 是否考虑时延 | 主要用途             |
| ------ | ------------------------- | ---------- | ------------ | -------------------- |
| `STOI` | 可懂度（Intelligibility） | 0 ~ 1      | 否           | 语音增强、语音分离   |
| `PESQ` | 主观质量（Quality）       | -0.5 ~ 4.5 | 是           | 编码、传输、语音增强 |

---

### 总结

- **STOI 更适合评估语音的可懂性**，适用于语音识别前端处理等对可懂度要求高的场景；
- **PESQ 更适合评估语音的主观质量**，适用于语音通信、语音编码等对听感质量敏感的场景；
- 在语音增强任务中，通常会同时使用这两个指标来全面评估系统性能。



## MOS

MOS 是 **Mean Opinion Score** 的缩写，是一种用于评估语音、视频或图像等多媒体信号**主观质量**的标准方法。它通过人类听觉感知实验得出评分，反映用户对语音质量的整体感受。

---

### 含义

- MOS 是一种**主观评价指标**，通常由一组听众对语音样本进行打分，然后计算平均值。
- 评分范围为 **1 到 5**：
  - `1`：非常差（Bad）
  - `2`：差（Poor）
  - `3`：一般（Fair）
  - `4`：好（Good）
  - `5`：非常好（Excellent）

---

### 应用场景

- 语音增强算法效果评估
- 语音编码标准（如 G.711、G.729）质量对比
- 网络传输中语音质量监控
- 智能语音助手、会议系统等用户体验测试

---

### 实验流程（主观测试）

1. **准备语音样本**：
   - 包括原始干净语音和不同算法处理后的语音。

2. **招募听众**：
   - 通常需要 16~24 名无听力障碍的听众。

3. **播放语音并打分**：
   - 听众根据听到的质量给出 1~5 分的评分。

4. **计算平均得分**：
   - 所有评分取平均即为该语音样本的 MOS 值。

---

### 客观 MOS 预测模型

为了减少主观测试的成本，已有多种**客观 MOS 预测模型**被提出，例如：

| 工具/模型                     | 描述                                                   |
| ----------------------------- | ------------------------------------------------------ |
| `PESQ`                        | 输出 MOS-LQO 分数，与主观 MOS 高度相关                 |
| `POLQA`                       | 更新一代的语音质量评估工具，支持宽带和超宽带语音       |
| `STOI`                        | 虽然不直接输出 MOS，但与可懂度高度相关，常作为辅助指标 |
| `Deep Learning MOS Predictor` | 使用神经网络端到端预测 MOS，如使用语音嵌入 + 回归层    |

---

### 示例代码（使用 PESQ 映射到 MOS）

```python
from pesq import pesq
import numpy as np

# clean_signal: 干净语音信号（numpy array）
# enhanced_signal: 增强后的语音信号（numpy array）
# fs: 采样率（8000 或 16000）

mos_score = pesq(fs, clean_signal, enhanced_signal, 'wb')  # 'wb' 表示 wideband
```


注意：PESQ 输出的 MOS-LQO 分数范围是 -0.5 到 4.5，越接近 4.5 表示质量越好。

---

### 总结

| 指标    | 类型 | 评分范围   | 特点                             |
| ------- | ---- | ---------- | -------------------------------- |
| `MOS`   | 主观 | 1 ~ 5      | 最真实反映人类听感               |
| `PESQ`  | 客观 | -0.5 ~ 4.5 | 支持时延检测，广泛用于通信领域   |
| `STOI`  | 客观 | 0 ~ 1      | 反映语音可懂度，适合语音识别前端 |
| `POLQA` | 客观 | 0 ~ 5      | 更高级别语音质量评估工具         |

在实际语音增强任务中，**MOS、PESQ 和 STOI 通常结合使用**，以全面评估语音质量和可懂性。

MOS 的中文全称是 **平均意见得分**，也叫 **平均主观评分**，英文为：

> **Mean Opinion Score**

它是一种**主观质量评估指标**，用于衡量语音、图像或视频等多媒体内容的**用户感知质量**。

---

### 对应术语解释（中文）

- **平均**：指的是多个测试者打分后的平均值；
- **意见**：表示听者对语音质量的主观感受；
- **得分 / 评分**：最终给出的一个数字结果，反映整体质量好坏；
- **主观评价**：基于人类感知（如听觉、视觉）进行打分，而不是通过算法自动计算。

---

### 常见翻译与别名

| 英文           | 中文                        | 说明                              |
| -------------- | --------------------------- | --------------------------------- |
| MOS            | 平均意见得分 / 平均主观评分 | 最常见用法                        |
| MOS-LQO        | 听音质量客观平均意见得分    | 来自 PESQ 等客观模型输出          |
| Subjective MOS | 主观 MOS                    | 由真人听众打分得出                |
| Objective MOS  | 客观 MOS                    | 由算法预测得到，如 PESQ、POLQA 等 |

---

### 示例说明

比如一段增强后的语音，经过 20 个人听后分别打分（1~5 分），最终平均得分为 4.2，那么我们说：

> 该语音的 **MOS 得分是 4.2**，表示语音质量较好，接近“好”到“非常好”之间。

---

### 总结

| 项目         | 内容                                 |
| ------------ | ------------------------------------ |
| 中文名称     | 平均意见得分 / 平均主观评分          |
| 英文缩写     | MOS（Mean Opinion Score）            |
| 用途         | 评估语音、图像、视频等媒体的主观质量 |
| 评分范围     | 1（非常差）～ 5（非常好）            |
| 获取方式     | 主观实验打分 或 客观算法预测         |
| 常见搭配工具 | `PESQ`, `POLQA`, `STOI` 等           |

如果你在论文或技术文档中看到 “MOS”，通常就是在说语音或图像的**主观质量评分**。